<!DOCTYPE html>
<html lang="en">
<head>
  <title>My Shopping Bag | Myntra Clone</title>
  <link rel="stylesheet" href="myntra.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <script src="bag.js" defer></script>
</head>
<body>
  <header>
    <div class="logo-container">
      <a href="myntra.html"><img class="myntrahome" src="images/myntra_logo.webp" alt="Myntra Home"></a>
    </div>

    <nav class="navbar">
      <a href="myntra.html#men">Men</a>
      <a href="myntra.html#women">Women</a>
      <a href="myntra.html#kid">Kids</a>
      <a href="myntra.html#home-living">Home & Living</a>
      <a href="myntra.html#footwear">Footwear</a>
      <a href="myntra.html#studio">Studio <sup>New</sup></a>
    </nav>

    <div class="acttion">
      <div class="acttion-container">
        <span class="material-symbols-outlined action-icon">person</span>
        <span class="action-name">Profile</span>
      </div>

      <div class="acttion-container" onclick="window.location.href='wishlist.html'">
        <span class="material-symbols-outlined action-icon">favorite</span>
        <span class="action-name">Wishlist</span>
        <span id="wishlist-count" class="count-badge">0</span>
        </div>

        <div class="acttion-container" onclick="window.location.href='bag.html'">
        <span class="material-symbols-outlined action-icon">shopping_bag</span>
        <span class="action-name">Bag</span>
        <span id="bag-count" class="count-badge">0</span>
        </div>
    </div>
  </header>

  <main class="bag-container">
    <div id="bag-items" class="product-section"></div>
    <div id="total-section"></div>
  </main>
<script>
    document.addEventListener("DOMContentLoaded", () => {
  const bagContainer = document.getElementById("bag-items");
  const totalSection = document.getElementById("total-section");
  const wishlistCount = document.getElementById("wishlist-count");
  const bagCount = document.getElementById("bag-count");

  let bag = JSON.parse(localStorage.getItem("bag")) || [];
  let wishlist = JSON.parse(localStorage.getItem("wishlist")) || [];

  updateCounts();
  renderBag();

  function renderBag() {
    bagContainer.innerHTML = "";

    if (bag.length === 0) {
      bagContainer.innerHTML = "<p style='text-align:center;'>Your bag is empty ðŸ›’</p>";
      totalSection.innerHTML = "";
      return;
    }

    let total = 0;
    bag.forEach((item, index) => {
      total += parseInt(item.price);
      const card = document.createElement("div");
      card.classList.add("product-card");
      card.innerHTML = `
        <img src="${item.image}" alt="${item.name}">
        <h3>${item.name}</h3>
        <p>â‚¹${item.price}</p>
        <div class="buttons">
          <button class="remove-btn" data-index="${index}">Remove</button>
        </div>
      `;
      bagContainer.appendChild(card);
    });

    totalSection.innerHTML = `
      <h3>Total Amount: â‚¹${total}</h3>
      <button class="checkout-btn">Proceed to Checkout</button>
    `;

    document.querySelectorAll(".remove-btn").forEach(btn =>
      btn.addEventListener("click", removeFromBag)
    );
  }

  function removeFromBag(e) {
    const index = e.target.dataset.index;
    const productName = bag[index].name;
    bag.splice(index, 1);
    localStorage.setItem("bag", JSON.stringify(bag));
    renderBag();
    updateCounts();
    showPopup(`${productName} removed from bag`);
  }

  function updateCounts() {
    wishlistCount.textContent = wishlist.length;
    bagCount.textContent = bag.length;
  }

  function showPopup(message) {
    const popup = document.createElement("div");
    popup.textContent = message;
    popup.className = "popup-message";
    document.body.appendChild(popup);
    setTimeout(() => popup.remove(), 2500);
  }
});

</script>
</body>
</html>
